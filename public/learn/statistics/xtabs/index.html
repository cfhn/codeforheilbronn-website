<!DOCTYPE html>
<html>
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
<!DOCTYPE html>
<html lang="en-us">



<link rel="stylesheet" href="/css/fonts.css">
<link rel="stylesheet" href="/css/main-site.css">
<link rel="stylesheet" href="/css/fa5-all.css">
<style type="text/css">
    /* Google Fonts */


body {
	background-color: <no value>;
	color: <no value>;
}

/* Links */

a {
  color: <no value>;
}

a:hover {
  color: <no value>;
}

a:focus {
  outline-color: <no value>;
}

.column25-left .sectionTitle a:hover:not(.current),
.column16-left .sectionTitle a:hover:not(.current) { /* Tutorial left sidebar */
  color: <no value>;
}

.icon-attribution, 
.icon-attribution a {
  color: <no value>;
  opacity: 75%;
}


/* Landing page content bands */

#homeContent .band.first {
  background-color: <no value>;
}

#homeContent .band.second {
  background-color: <no value>;
}

#homeContent .band.third {
  background-color: <no value>;
}

/* Top navigation bar menu */

#rStudioHeader {
  background-color: <no value>;
  color: <no value>;
}

#rStudioHeader .productName {
  color: <no value>;
}

#rStudioHeader .productName:hover,
#rStudioHeader .productName:focus {
  color: <no value>;
}

#rStudioHeader #menu .menuItem.a {
  background-color: #75aadb;
  color: <no value>;
}

#rStudioHeader #menu .menuItem:hover {
  background-color: <no value>;
  color: <no value>;
}

#rStudioHeader #menu .menuItem.current {
  background-color: <no value>;
  color: <no value>;
  text-decoration: <no value>;
}

/* Footer */

#rStudioFooter.band {
  background-color: <no value>;
}

#rStudioFooter .bandContent #copyright {
  color: <no value>;
}

/* Tables */

table tbody tr:nth-child(even){
  background-color: <no value>;
}

table tbody tr:nth-child(odd){
  background-color: <no value>;
}

.latest {
  border-top: .5em solid <no value>;
}


/* ------Accent Font------- */





/* ----Accent color for headers, toc, etc.----- */



/* Custom colored bullets */



/* ------Capitalization of Headers------- */

  

/* -----Hexes------*/


/*----- Borders------ */



/*--- Event Stickies ---*/


















/* ------Test Drive Button-------*/














 

</style>




<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.147.2">
<title>Statistical analysis of contingency tables</title>
<meta property="og:title" content="Statistical analysis of contingency tables" />
<meta property="og:description" content="Use tests of independence and goodness of fit to analyze tables of counts.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/learn/statistics/xtabs/" />



<meta property="twitter:card" content="summary_large_image">



<meta property="og:url" content="//localhost:1313/learn/statistics/xtabs/">
  <meta property="og:site_name" content="Education">
  <meta property="og:title" content="Statistical analysis of contingency tables">
  <meta property="og:description" content="Use tests of independence and goodness of fit to analyze tables of counts.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="learn">
    <meta property="article:tag" content="Infer">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Statistical analysis of contingency tables">
  <meta name="twitter:description" content="Use tests of independence and goodness of fit to analyze tables of counts.">



<link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png" />
<link rel="manifest" href="/images/favicons/site.webmanifest" />
<link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" />
<link rel="shortcut icon" href="/images/favicons/favicon.ico" />
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" href="/images/favicons/browserconfig.xml" >



<script type="text/javascript" src="/js/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="/js/site.js"></script>








<link rel="icon" href="/images/favicon.ico" />


  
<script type="text/javascript" src="/js/clipboard.js"></script>






  







  <body>
    <div id="appTidyverseSite" class="shrinkHeader alwaysShrinkHeader">
      <div id="main">
        
        <div id="rStudioHeader">
          <div class="band">
            <div class="innards bandContent">
              <div>
                <a class="productName" href="/">Education</a>
                
              </div>
              <div id="menu">
  <div id="menuToggler"></div>
  <div id="menuItems" class="">
    
    
  </div>
</div>

            </div>
          </div>
        </div>
</head>
<body>


 




<div class="band padForHeader pushFooter">
  <div class="bandContent">
    <div class="full splitColumns withMobileMargins">
      <div class="column75">

      <h1 class="article-title">Statistical analysis of contingency tables</h1>

      
      <div class="article-header" aria-hidden="true">
          
        
      </div>

      
      
      
      
        </p>

      <div class="article-content">
      



<h2 id="introduction">Introduction
  <a href="#introduction">
    <svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>This article only requires that you have the tidymodels package installed.</p>
<p>In this vignette, we&rsquo;ll walk through conducting a <code>\(\chi^2\)</code> (chi-squared) test of independence and a chi-squared goodness of fit test using infer. We&rsquo;ll start out with a chi-squared test of independence, which can be used to test the association between two categorical variables. Then, we&rsquo;ll move on to a chi-squared goodness of fit test, which tests how well the distribution of one categorical variable can be approximated by some theoretical distribution.</p>
<p>Throughout this vignette, we&rsquo;ll make use of the <code>ad_data</code> data set (available in the modeldata package, which is part of tidymodels). This data set is related to cognitive impairment in 333 patients from 
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3079734/" target="_blank" rel="noopener">Craig-Schapiro <em>et al</em> (2011)</a>. See <code>?ad_data</code> for more information on the variables included and their source. One of the main research questions in these data were how a person&rsquo;s genetics related to the Apolipoprotein E gene affect their cognitive skills. The data shows:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">library</span>(tidymodels) <span style="color:#408080;font-style:italic"># Includes the infer package</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">data</span>(ad_data, package <span style="color:#666">=</span> <span style="color:#ba2121">&#34;modeldata&#34;</span>)
</span></span><span style="display:flex;"><span>ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">select</span>(Genotype, Class)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 333 x 2</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    Genotype Class   </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    &lt;fct&gt;    &lt;fct&gt;   </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  1 E3E3     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  2 E3E4     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  3 E3E4     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  4 E3E4     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  5 E3E3     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  6 E4E4     Impaired</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  7 E2E3     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  8 E2E3     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;  9 E3E3     Control </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 10 E2E3     Impaired</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # â€¦ with 323 more rows</span>
</span></span></code></pre></div><p>The three main genetic variants are called E2, E3, and E4. The values in <code>Genotype</code> represent the genetic makeup of patients based on what they inherited from their parents (i.e, a value of &ldquo;E2E4&rdquo; means E2 from one parent and E4 from the other).</p>




<h2 id="test-of-independence">Test of independence
  <a href="#test-of-independence">
    <svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>To carry out a chi-squared test of independence, we&rsquo;ll examine the association between their cognitive ability (impaired and healthy) and the genetic makeup. This is what the relationship looks like in the sample data:</p>
<img src="figs/plot-indep-1.svg" width="672" />
<p>If there were no relationship, we would expect to see the purple bars reaching to the same length, regardless of cognitive ability. Are the differences we see here, though, just due to random noise?</p>
<p>First, to calculate the observed statistic, we can use <code>specify()</code> and <code>calculate()</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># calculate the observed statistic</span>
</span></span><span style="display:flex;"><span>observed_indep_statistic <span style="color:#666">&lt;-</span> ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(Genotype <span style="color:#666">~</span> Class) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">calculate</span>(stat <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Chisq&#34;</span>)
</span></span></code></pre></div><p>The observed <code>\(\chi^2\)</code> statistic is 21.577. Now, we want to compare this statistic to a null distribution, generated under the assumption that these variables are not actually related, to get a sense of how likely it would be for us to see this observed statistic if there were actually no association between cognitive ability and genetics.</p>
<p>We can <code>generate()</code> the null distribution in one of two ways: using randomization or theory-based methods. The randomization approach permutes the response and explanatory variables, so that each person&rsquo;s genetics is matched up with a random cognitive rating from the sample in order to break up any association between the two.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># generate the null distribution using randomization</span>
</span></span><span style="display:flex;"><span>null_distribution_simulated <span style="color:#666">&lt;-</span> ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(Genotype <span style="color:#666">~</span> Class) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">hypothesize</span>(null <span style="color:#666">=</span> <span style="color:#ba2121">&#34;independence&#34;</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">generate</span>(reps <span style="color:#666">=</span> <span style="color:#666">5000</span>, type <span style="color:#666">=</span> <span style="color:#ba2121">&#34;permute&#34;</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">calculate</span>(stat <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Chisq&#34;</span>)
</span></span></code></pre></div><p>Note that, in the line <code>specify(Genotype ~ Class)</code> above, we could use the equivalent syntax <code>specify(response = Genotype, explanatory = Class)</code>. The same goes in the code below, which generates the null distribution using theory-based methods instead of randomization.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># generate the null distribution by theoretical approximation</span>
</span></span><span style="display:flex;"><span>null_distribution_theoretical <span style="color:#666">&lt;-</span> ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(Genotype <span style="color:#666">~</span> Class) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">hypothesize</span>(null <span style="color:#666">=</span> <span style="color:#ba2121">&#34;independence&#34;</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#408080;font-style:italic"># note that we skip the generation step here!</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">calculate</span>(stat <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Chisq&#34;</span>)
</span></span></code></pre></div><p>To get a sense for what these distributions look like, and where our observed statistic falls, we can use <code>visualize()</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># visualize the null distribution and test statistic!</span>
</span></span><span style="display:flex;"><span>null_distribution_simulated <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">visualize</span>() <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">shade_p_value</span>(observed_indep_statistic,
</span></span><span style="display:flex;"><span>                direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span></code></pre></div><img src="figs/visualize-indep-1.svg" width="672" />
<p>We could also visualize the observed statistic against the theoretical null distribution. Note that we skip the <code>generate()</code> and <code>calculate()</code> steps when using the theoretical approach, and that we now need to provide <code>method = &quot;theoretical&quot;</code> to <code>visualize()</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># visualize the theoretical null distribution and test statistic!</span>
</span></span><span style="display:flex;"><span>ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(Genotype <span style="color:#666">~</span> Class) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">hypothesize</span>(null <span style="color:#666">=</span> <span style="color:#ba2121">&#34;independence&#34;</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">visualize</span>(method <span style="color:#666">=</span> <span style="color:#ba2121">&#34;theoretical&#34;</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">shade_p_value</span>(observed_indep_statistic,
</span></span><span style="display:flex;"><span>                direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span></code></pre></div><img src="figs/visualize-indep-theor-1.svg" width="672" />
<p>To visualize both the randomization-based and theoretical null distributions to get a sense of how the two relate, we can pipe the randomization-based null distribution into <code>visualize()</code>, and further provide <code>method = &quot;both&quot;</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># visualize both null distributions and the test statistic!</span>
</span></span><span style="display:flex;"><span>null_distribution_simulated <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">visualize</span>(method <span style="color:#666">=</span> <span style="color:#ba2121">&#34;both&#34;</span>) <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">shade_p_value</span>(observed_indep_statistic,
</span></span><span style="display:flex;"><span>                direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span></code></pre></div><img src="figs/visualize-indep-both-1.svg" width="672" />
<p>Either way, it looks like our observed test statistic would be fairly unlikely if there were actually no association between cognition and genotype. More exactly, we can calculate the p-value:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># calculate the p value from the observed statistic and null distribution</span>
</span></span><span style="display:flex;"><span>p_value_independence <span style="color:#666">&lt;-</span> null_distribution_simulated <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">get_p_value</span>(obs_stat <span style="color:#666">=</span> observed_indep_statistic,
</span></span><span style="display:flex;"><span>              direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p_value_independence
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 x 1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;    p_value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;      &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1 0.000600</span>
</span></span></code></pre></div><p>Thus, if there were really no relationship between cognition and genotype, the probability that we would see a statistic as or more extreme than 21.577 is approximately 6\times 10^{-4}.</p>
<p>Note that, equivalently to the steps shown above, the package supplies a wrapper function, <code>chisq_test</code>, to carry out Chi-Squared tests of independence on tidy data. The syntax goes like this:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">chisq_test</span>(ad_data, Genotype <span style="color:#666">~</span> Class)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 x 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   statistic chisq_df  p_value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;       &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1      21.6        5 0.000630</span>
</span></span></code></pre></div>



<h2 id="goodness-of-fit">Goodness of fit
  <a href="#goodness-of-fit">
    <svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>Now, moving on to a chi-squared goodness of fit test, we&rsquo;ll take a look at just the genotype data. Many papers have investigated the relationship of Apolipoprotein E to diseases. For example, 
<a href="https://annals.org/aim/article-abstract/717641/meta-analysis-apolipoprotein-e-genotypes-risk-coronary-heart-disease" target="_blank" rel="noopener">Song <em>et al</em> (2004)</a> conducted a meta-analysis of numerous studies that looked at this gene and heart disease. In their paper, they describe the frequency of the different genotypes across many samples. For the cognition study, it might be interesting to see if our sample of genotypes was consistent with this literature (treating the rates, for this analysis, as known).</p>
<p>The rates of the meta-analysis and our observed data are:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Song, Y., Stampfer, M. J., &amp; Liu, S. (2004). Meta-Analysis: Apolipoprotein E </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># Genotypes and Risk for Coronary Heart Disease. Annals of Internal Medicine, </span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># 141(2), 137.</span>
</span></span><span style="display:flex;"><span>meta_rates <span style="color:#666">&lt;-</span> <span style="color:#00f">c</span>(<span style="color:#ba2121">&#34;E2E2&#34;</span> <span style="color:#666">=</span> <span style="color:#666">0.71</span>, <span style="color:#ba2121">&#34;E2E3&#34;</span> <span style="color:#666">=</span> <span style="color:#666">11.4</span>, <span style="color:#ba2121">&#34;E2E4&#34;</span> <span style="color:#666">=</span> <span style="color:#666">2.32</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#ba2121">&#34;E3E3&#34;</span> <span style="color:#666">=</span> <span style="color:#666">61.0</span>, <span style="color:#ba2121">&#34;E3E4&#34;</span> <span style="color:#666">=</span> <span style="color:#666">22.6</span>, <span style="color:#ba2121">&#34;E4E4&#34;</span> <span style="color:#666">=</span> <span style="color:#666">2.22</span>)
</span></span><span style="display:flex;"><span>meta_rates <span style="color:#666">&lt;-</span> meta_rates<span style="color:#666">/</span><span style="color:#00f">sum</span>(meta_rates) <span style="color:#408080;font-style:italic"># these add up to slightly &gt; 100%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>obs_rates <span style="color:#666">&lt;-</span> <span style="color:#00f">table</span>(ad_data<span style="color:#666">$</span>Genotype)<span style="color:#666">/</span><span style="color:#00f">nrow</span>(ad_data)
</span></span><span style="display:flex;"><span><span style="color:#00f">round</span>(<span style="color:#00f">cbind</span>(obs_rates, meta_rates) <span style="color:#666">*</span> <span style="color:#666">100</span>, <span style="color:#666">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;      obs_rates meta_rates</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E2E2       0.6       0.71</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E2E3      11.1      11.37</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E2E4       2.4       2.31</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E3E3      50.1      60.85</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E3E4      31.8      22.54</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; E4E4       3.9       2.21</span>
</span></span></code></pre></div><p>Suppose our null hypothesis is that <code>Genotype</code> follows the same frequency distribution as the meta-analysis. Lets now test whether this difference in distributions is statistically significant.</p>
<p>First, to carry out this hypothesis test, we would calculate our observed statistic.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># calculating the null distribution</span>
</span></span><span style="display:flex;"><span>observed_gof_statistic <span style="color:#666">&lt;-</span> ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(response <span style="color:#666">=</span> Genotype) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">hypothesize</span>(null <span style="color:#666">=</span> <span style="color:#ba2121">&#34;point&#34;</span>, p <span style="color:#666">=</span> meta_rates) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">calculate</span>(stat <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Chisq&#34;</span>)
</span></span></code></pre></div><p>The observed statistic is 23.384. Now, generating a null distribution, by just dropping in a call to <code>generate()</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># generating a null distribution</span>
</span></span><span style="display:flex;"><span>null_distribution_gof <span style="color:#666">&lt;-</span> ad_data <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">specify</span>(response <span style="color:#666">=</span> Genotype) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">hypothesize</span>(null <span style="color:#666">=</span> <span style="color:#ba2121">&#34;point&#34;</span>, p <span style="color:#666">=</span> meta_rates) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">generate</span>(reps <span style="color:#666">=</span> <span style="color:#666">5000</span>, type <span style="color:#666">=</span> <span style="color:#ba2121">&#34;simulate&#34;</span>) <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">calculate</span>(stat <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Chisq&#34;</span>)
</span></span></code></pre></div><p>Again, to get a sense for what these distributions look like, and where our observed statistic falls, we can use <code>visualize()</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># visualize the null distribution and test statistic!</span>
</span></span><span style="display:flex;"><span>null_distribution_gof <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">visualize</span>() <span style="color:#666">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#00f">shade_p_value</span>(observed_gof_statistic,
</span></span><span style="display:flex;"><span>                direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span></code></pre></div><img src="figs/visualize-indep-gof-1.svg" width="672" />
<p>This statistic seems like it would be unlikely if our rates were the same as the rates from the meta-analysis! How unlikely, though? Calculating the p-value:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># calculate the p-value</span>
</span></span><span style="display:flex;"><span>p_value_gof <span style="color:#666">&lt;-</span> null_distribution_gof <span style="color:#666">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">get_p_value</span>(observed_gof_statistic,
</span></span><span style="display:flex;"><span>              direction <span style="color:#666">=</span> <span style="color:#ba2121">&#34;greater&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p_value_gof
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 x 1</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   p_value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;     &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1  0.0008</span>
</span></span></code></pre></div><p>Thus, if each genotype occurred at the same rate as the Song paper, the probability that we would see a distribution like the one we did is approximately 8\times 10^{-4}.</p>
<p>Again, equivalently to the steps shown above, the package supplies a wrapper function, <code>chisq_test</code>, to carry out chi-squared goodness of fit tests on tidy data. The syntax goes like this:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#00f">chisq_test</span>(ad_data, response <span style="color:#666">=</span> Genotype, p <span style="color:#666">=</span> meta_rates)
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; # A tibble: 1 x 3</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;   statistic chisq_df  p_value</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">#&gt; 1      23.4        5 0.000285</span>
</span></span></code></pre></div>



<h2 id="session-information">Session information
  <a href="#session-information">
    <svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><pre tabindex="0"><code>#&gt; â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#&gt;  setting  value                       
#&gt;  version  R version 3.6.2 (2019-12-12)
#&gt;  os       macOS Mojave 10.14.6        
#&gt;  system   x86_64, darwin15.6.0        
#&gt;  ui       X11                         
#&gt;  language (EN)                        
#&gt;  collate  en_US.UTF-8                 
#&gt;  ctype    en_US.UTF-8                 
#&gt;  tz       America/Denver              
#&gt;  date     2020-04-17                  
#&gt; 
#&gt; â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#&gt;  package    * version date       lib source        
#&gt;  broom      * 0.5.5   2020-02-29 [1] CRAN (R 3.6.0)
#&gt;  dials      * 0.0.6   2020-04-03 [1] CRAN (R 3.6.2)
#&gt;  dplyr      * 0.8.5   2020-03-07 [1] CRAN (R 3.6.0)
#&gt;  ggplot2    * 3.3.0   2020-03-05 [1] CRAN (R 3.6.0)
#&gt;  infer      * 0.5.1   2019-11-19 [1] CRAN (R 3.6.0)
#&gt;  parsnip    * 0.1.0   2020-04-09 [1] CRAN (R 3.6.2)
#&gt;  purrr      * 0.3.3   2019-10-18 [1] CRAN (R 3.6.0)
#&gt;  recipes    * 0.1.10  2020-03-18 [1] CRAN (R 3.6.0)
#&gt;  rlang        0.4.5   2020-03-01 [1] CRAN (R 3.6.0)
#&gt;  rsample    * 0.0.6   2020-03-31 [1] CRAN (R 3.6.2)
#&gt;  tibble     * 2.1.3   2019-06-06 [1] CRAN (R 3.6.2)
#&gt;  tidymodels * 0.1.0   2020-02-16 [1] CRAN (R 3.6.0)
#&gt;  tune       * 0.1.0   2020-04-02 [1] CRAN (R 3.6.2)
#&gt;  workflows  * 0.1.1   2020-03-17 [1] CRAN (R 3.6.0)
#&gt;  yardstick  * 0.0.6   2020-03-17 [1] CRAN (R 3.6.0)
#&gt; 
#&gt; [1] /Library/Frameworks/R.framework/Versions/3.6/Resources/library
</code></pre>
      </div>


      

      </div> 
      
      <div class="column25">
        <div class="section hideOnMobile">
          
          <div class="sectionTitle">Contents</div>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#test-of-independence">Test of independence</a></li>
    <li><a href="#goodness-of-fit">Goodness of fit</a></li>
    <li><a href="#session-information">Session information</a></li>
  </ul>
</nav>
          
        </div>
        <div class="section">
          





        </div>
      </div> 

    </div> 
  </div>  
</div> 



        <div id="rStudioFooter" class="band">
          <div class="bandContent">
            <div id="copyright">
              
              
            </div>
            <div id="logos">
              <a href="" class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a>
              <a href="" class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a>
            </div>
          </div>
        </div>

      </div>  
    </div>  

    




<script src="//cdn.bootcss.com/highlight.js//highlight.min.js"></script>



<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>




    
<script src="/js/math-code.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    

  </body>
</html>

</body>
</html>
